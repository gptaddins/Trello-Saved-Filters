<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Saved Filters Power-Up</title>
  <script src="https://p.trellocdn.com/power-up.min.js"></script>
</head>
<body>
  <script>
    window.TrelloPowerUp.initialize({
      'board-bar': function(t, options) {
        return [{
          title: 'Filters',
          icon: 'https://your-hosted-icon.png', // Replace with search icon URL
          condition: 'always',
          callback: function(t) {
            return t.sizeTo('#filters-panel').then(function() {
              return {
                url: './board.html',
                height: '100%'
              };
            });
          }
        }];
      },
      'card-badges': function(t, options) {
        return t.card('all').then(function(card) {
          var query = t.get('board', 'private', 'activeQuery', '');
          if (query) {
            return t.getRestApi().getToken().then(function(token) {
              var appKey = t.arg('appKey') || 'your-app-key-here';
              var url = 'https://api.trello.com/1/search?query=' + encodeURIComponent(query) +
                        '&modelTypes=cards&cards_limit=100&key=' + appKey + '&token=' + token;
              return fetch(url).then(function(response) {
                return response.json();
              }).then(function(data) {
                if (data.cards && data.cards.some(c => c.id === card.id)) {
                  return [{
                    text: 'âœ“', // Filter match indicator
                    color: 'green'
                  }];
                }
                return [];
              });
            });
          }
          return [];
        });
      }
    }, {
      appKey: '72d09526a2855680e12a04e38b04637c', // Replace with your API key
      appName: 'Saved Filters'
    });
  </script>
</body>
</html>
